<!-- app/views/forms/new.html.erb -->
<!DOCTYPE html>
<html>
<head>
  <title>FormApp</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= stylesheet_link_tag "new_form" %>
  <%= stylesheet_link_tag "display"%>
  <%= csrf_meta_tag %>
</head>

<section>

  <h2>User's Forms</h2>

  <% @forms = Form.find_all_by_owner_id(current_user.id)%>
<div class='display_field group'>
  <% @forms.each do |form| %>
  <div class='display-row'>

  <div class='right-display-column'>
    <h2>The rendered form</h2>
    <h3><%=form.form_name%></h3>



            <%= generate_header(form).html_safe%>
            <br>
              <% form.entries.each do |entry| %>

                <% @label = entry.as_json["label"] %>
                <%= @label %>
                <br>
                <% @instructions = entry.as_json["instructions"] %>
                Instructions for <%= @label || "this entry" %>: <%= @instructions %>
                <% @form_hash  = entry.as_json.reject {|k,v| v==nil}.reject{|k,v| k=="created_at" || k=="updated_at" || k=="instructions" } %>

                <br>
                <% @form_hash2 = @form_hash.dup %>
                <%=form_gen(@form_hash)%>

              <% end %>

            <br>
              </div>
            <div class='left-display-column'>
            <h2>The code!</h2>
              <div>
              <label class='code-label'>Header
                  <br>
              <%= form.header_text%>
              </label>
              <br>
              <br>
              <label class='code-label'>The Entries
              <br>
              <br>

              <% form.entries.each do |entry| %>
              <br>
              <br>

              <%= entry.parsed_input %>
              <br>
              <% end %>
              </label>
              <br>
              <br>
              <label class='code-label'>Closing Text<br>
              <%= form.closing_text%>
              </label>
              </div>
              </div>
            </div>


          <% end %>

        </div>


</section>

</html>